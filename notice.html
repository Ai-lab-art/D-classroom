<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Notice - D classroom</title>
    <link rel="stylesheet" href="style.css">
    <style>
        .notice-container {
            max-width: 900px;
            margin: 2rem auto;
            background: #fff;
            border-radius: 12px;
            box-shadow: 0 2px 12px rgba(37,99,235,0.07);
            padding: 2rem;
        }
        .notice-embed {
            width: 100%;
            min-height: 500px;
            border: 2px solid #bcd0ee;
            border-radius: 8px;
        }
        .notice-instructions {
            color: #2563eb;
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }
    </style>
</head>
<body>
    <!-- Removed the navigation bar so the title menu only appears on the home page -->
    <main class="notice-container">
        <h2 style="color:#2563eb;">Notices</h2>
        <div style="text-align:right; margin-bottom:1rem;">
            <a href="index.html" style="background:#2563eb;color:#fff;padding:0.5rem 1.2rem;border-radius:6px;text-decoration:none;font-weight:500;">Go to Main Menu</a>
        </div>
        <!-- Auto-updating Government Notices Section -->
        <section id="gov-notices-section" style="background:#f4f8fb; border-radius:10px; box-shadow:0 2px 8px rgba(37,99,235,0.07); padding:1.2rem 1.5rem 1.2rem 1.5rem; margin-bottom:2rem;">
            <h3 style="color:#2563eb; margin-top:0;">Latest Government Education Notices (Auto-updated)</h3>
            <ul id="gov-notices-list" style="padding-left:1.2rem; margin-bottom:0.7rem;"></ul>
            <div style="font-size:0.97em; color:#444;">These notices are fetched automatically from official government education portals. <span style='color:#e74c3c'>If you see nothing, the source may be temporarily unavailable.</span></div>
        </section>
        <!-- Governmental Portals Official Notices Section -->
        <section style="background:#f4f8fb; border-radius:10px; box-shadow:0 2px 8px rgba(37,99,235,0.07); padding:1.2rem 1.5rem 1.2rem 1.5rem; margin-bottom:2rem;">
            <h3 style="color:#2563eb; margin-top:0;">Governmental Portals ‚Äì Education Notices</h3>
            <ul style="padding-left:1.2rem; margin-bottom:0.7rem;">
                <li><b>Ministry of Education, Science and Technology (MoEST):</b> <a href="https://moest.gov.np/" target="_blank">moest.gov.np</a></li>
                <li><b>Curriculum Development Centre (CDC) ‚Äì Latest Educational Notices:</b> <a href="https://moecdc.gov.np/en" target="_blank">moecdc.gov.np/en</a>
                    <ul style="margin-top:0.3rem;">
                        <li style="display:flex;align-items:center;gap:0.5em;"><a href="https://moecdc.gov.np/en" target="_blank">‡§•‡§™ ‡§™‡§æ‡§†‡•ç‡§Ø‡§∏‡§æ‡§Æ‡§ó‡•ç‡§∞‡•Ä ‡§§‡§•‡§æ ‡§°‡§ø‡§ú‡§ø‡§ü‡§≤ ‡§∏‡§ø‡§ï‡§æ‡§á ‡§∏‡§æ‡§Æ‡§ó‡•ç‡§∞‡•Ä ‡§Æ‡•Ç‡§≤‡•ç‡§Ø‡§æ‡§ô‡•ç‡§ï‡§®‡§ï‡§æ ‡§≤‡§æ‡§ó‡§ø ‡§∏‡•Ç‡§ö‡§®‡§æ</a> <button class="subnotice-share-btn" data-title="‡§•‡§™ ‡§™‡§æ‡§†‡•ç‡§Ø‡§∏‡§æ‡§Æ‡§ó‡•ç‡§∞‡•Ä ‡§§‡§•‡§æ ‡§°‡§ø‡§ú‡§ø‡§ü‡§≤ ‡§∏‡§ø‡§ï‡§æ‡§á ‡§∏‡§æ‡§Æ‡§ó‡•ç‡§∞‡•Ä ‡§Æ‡•Ç‡§≤‡•ç‡§Ø‡§æ‡§ô‡•ç‡§ï‡§®‡§ï‡§æ ‡§≤‡§æ‡§ó‡§ø ‡§∏‡•Ç‡§ö‡§®‡§æ" data-url="https://moecdc.gov.np/en" style="background:none;border:none;cursor:pointer;font-size:1.1em;">üîó</button></li>
                        <li style="display:flex;align-items:center;gap:0.5em;"><a href="https://moecdc.gov.np/en" target="_blank">‡§Æ‡§æ‡§®‡•ç‡§Ø‡§§‡§æ ‡§§‡§•‡§æ ‡§∏‡§Æ‡§ï‡§ï‡•ç‡§∑‡§§‡§æ ‡§∞‡§¶‡•ç‡§¶ ‡§ó‡§∞‡§ø‡§è‡§ï‡•ã ‡§∏‡•Ç‡§ö‡§®‡§æ (‡§∂‡•à‡§ï‡•ç‡§∑‡§ø‡§ï ‡§™‡•ç‡§∞‡§Æ‡§æ‡§£‡§™‡§§‡•ç‡§∞)</a> <button class="subnotice-share-btn" data-title="‡§Æ‡§æ‡§®‡•ç‡§Ø‡§§‡§æ ‡§§‡§•‡§æ ‡§∏‡§Æ‡§ï‡§ï‡•ç‡§∑‡§§‡§æ ‡§∞‡§¶‡•ç‡§¶ ‡§ó‡§∞‡§ø‡§è‡§ï‡•ã ‡§∏‡•Ç‡§ö‡§®‡§æ (‡§∂‡•à‡§ï‡•ç‡§∑‡§ø‡§ï ‡§™‡•ç‡§∞‡§Æ‡§æ‡§£‡§™‡§§‡•ç‡§∞)" data-url="https://moecdc.gov.np/en" style="background:none;border:none;cursor:pointer;font-size:1.1em;">üîó</button></li>
                        <li style="display:flex;align-items:center;gap:0.5em;"><a href="https://moecdc.gov.np/en" target="_blank">‡§µ‡§ø‡§¶‡•á‡§∂‡•Ä ‡§®‡§æ‡§ó‡§∞‡§ø‡§ï ‡§§‡§•‡§æ ‡§¨‡•ã‡§∞‡•ç‡§°‡§≤‡§æ‡§à ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ‡§ø‡§ï ‡§∂‡§ø‡§ï‡•ç‡§∑‡§æ ‡§∏‡§∞‡§π‡§ï‡•ã ‡§∏‡§Æ‡§ï‡§ï‡•ç‡§∑‡§§‡§æ ‡§∏‡•á‡§µ‡§æ ‡§∏‡•Ç‡§ö‡§®‡§æ</a> <button class="subnotice-share-btn" data-title="‡§µ‡§ø‡§¶‡•á‡§∂‡•Ä ‡§®‡§æ‡§ó‡§∞‡§ø‡§ï ‡§§‡§•‡§æ ‡§¨‡•ã‡§∞‡•ç‡§°‡§≤‡§æ‡§à ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ‡§ø‡§ï ‡§∂‡§ø‡§ï‡•ç‡§∑‡§æ ‡§∏‡§∞‡§π‡§ï‡•ã ‡§∏‡§Æ‡§ï‡§ï‡•ç‡§∑‡§§‡§æ ‡§∏‡•á‡§µ‡§æ ‡§∏‡•Ç‡§ö‡§®‡§æ" data-url="https://moecdc.gov.np/en" style="background:none;border:none;cursor:pointer;font-size:1.1em;">üîó</button></li>
                    </ul>
                </li>
                <li><b>SEE Examination Board:</b> <a href="https://see.gov.np/" target="_blank">see.gov.np</a></li>
                <li><b>Department of Education (DoE) / CEHRD ‚Äì Latest Educational Notices:</b> <a href="https://doe.gov.np/" target="_blank">doe.gov.np</a>
                    <ul style="margin-top:0.3rem;">
                        <li style="display:flex;align-items:center;gap:0.5em;"><a href="https://doe.gov.np/" target="_blank">‡§™‡§æ‡§†‡•ç‡§Ø‡§™‡•Å‡§∏‡•ç‡§§‡§ï ‡§§‡§•‡§æ ‡§™‡§æ‡§†‡•ç‡§Ø‡§∏‡§æ‡§Æ‡§ó‡•ç‡§∞‡•Ä‡§ï‡•ã ‡§Ö‡§®‡•Å‡§ó‡§Æ‡§® ‡§∏‡§Æ‡•ç‡§¨‡§®‡•ç‡§ß‡§Æ‡§æ ‡§∏‡•Ç‡§ö‡§®‡§æ</a> <button class="subnotice-share-btn" data-title="‡§™‡§æ‡§†‡•ç‡§Ø‡§™‡•Å‡§∏‡•ç‡§§‡§ï ‡§§‡§•‡§æ ‡§™‡§æ‡§†‡•ç‡§Ø‡§∏‡§æ‡§Æ‡§ó‡•ç‡§∞‡•Ä‡§ï‡•ã ‡§Ö‡§®‡•Å‡§ó‡§Æ‡§® ‡§∏‡§Æ‡•ç‡§¨‡§®‡•ç‡§ß‡§Æ‡§æ ‡§∏‡•Ç‡§ö‡§®‡§æ" data-url="https://doe.gov.np/" style="background:none;border:none;cursor:pointer;font-size:1.1em;">üîó</button></li>
                        <li style="display:flex;align-items:center;gap:0.5em;"><a href="https://doe.gov.np/" target="_blank">‡§∏‡§æ‡§∞‡•ç‡§µ‡§ú‡§®‡§ø‡§ï ‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ‡§≤‡§Ø‡§π‡§≤‡§æ‡§à ‡§Ö‡§®‡•Å‡§¶‡§æ‡§® ‡§∏‡§Æ‡•ç‡§¨‡§®‡•ç‡§ß‡•Ä ‡§∏‡•Ç‡§ö‡§®‡§æ</a> <button class="subnotice-share-btn" data-title="‡§∏‡§æ‡§∞‡•ç‡§µ‡§ú‡§®‡§ø‡§ï ‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ‡§≤‡§Ø‡§π‡§≤‡§æ‡§à ‡§Ö‡§®‡•Å‡§¶‡§æ‡§® ‡§∏‡§Æ‡•ç‡§¨‡§®‡•ç‡§ß‡•Ä ‡§∏‡•Ç‡§ö‡§®‡§æ" data-url="https://doe.gov.np/" style="background:none;border:none;cursor:pointer;font-size:1.1em;">üîó</button></li>
                        <li style="display:flex;align-items:center;gap:0.5em;"><a href="https://doe.gov.np/" target="_blank">‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ‡§∞‡•ç‡§•‡•Ä ‡§≠‡§∞‡•ç‡§®‡§æ ‡§Ö‡§≠‡§ø‡§Ø‡§æ‡§® ‡§∞ ICT ‡§∂‡§ø‡§ï‡•ç‡§∑‡§æ‡§∏‡§Æ‡•ç‡§¨‡§®‡•ç‡§ß‡•Ä ‡§∏‡•Ç‡§ö‡§®‡§æ</a> <button class="subnotice-share-btn" data-title="‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ‡§∞‡•ç‡§•‡•Ä ‡§≠‡§∞‡•ç‡§®‡§æ ‡§Ö‡§≠‡§ø‡§Ø‡§æ‡§® ‡§∞ ICT ‡§∂‡§ø‡§ï‡•ç‡§∑‡§æ‡§∏‡§Æ‡•ç‡§¨‡§®‡•ç‡§ß‡•Ä ‡§∏‡•Ç‡§ö‡§®‡§æ" data-url="https://doe.gov.np/" style="background:none;border:none;cursor:pointer;font-size:1.1em;">üîó</button></li>
                    </ul>
                </li>
                <li><b>Tribhuvan University (TU):</b> <a href="https://tudoms.tu.edu.np/" target="_blank">tudoms.tu.edu.np</a></li>
                <li><b>e-Pustakalaya (Digital Library):</b> <a href="https://www.pustakalaya.org/" target="_blank">pustakalaya.org</a></li>
                <li><b>Looma (Educational Platform):</b> <a href="https://www.looma.website/" target="_blank">looma.website</a></li>
                <li><b>Nepal Government Portal (Education Section):</b> <a href="https://nepal.gov.np/" target="_blank">nepal.gov.np</a></li>
            </ul>
            <div style="font-size:0.97em; color:#444;">Only education-related official notices from these portals are highlighted here for your convenience.</div>
        </section>
        <div style="text-align:right; margin-bottom:1rem;">
            <button id="add-notice-btn" style="background:#2563eb; color:#fff; border:none; border-radius:50%; width:36px; height:36px; font-size:1.3rem; cursor:pointer;">+</button>
        </div>
        <form id="notice-form" style="display:none; margin-bottom:2rem;">
            <input type="text" id="notice-title" placeholder="Title" required style="width:100%;padding:0.7rem;margin-bottom:0.7rem;font-size:1.1rem;border:1px solid #bcd0ee;border-radius:5px;">
            <textarea id="notice-content" placeholder="Write your notice here..." required style="width:100%;padding:0.7rem;height:120px;font-size:1.1rem;border:1px solid #bcd0ee;border-radius:5px;"></textarea>
            <button type="submit" style="background:#2563eb;color:#fff;border:none;padding:0.7rem 2rem;border-radius:5px;font-size:1rem;cursor:pointer;margin-top:0.5rem;">Add Notice</button>
        </form>
        <div id="notices-list"></div>
    </main>
    <script>
    const addBtn = document.getElementById('add-notice-btn');
    const form = document.getElementById('notice-form');
    const noticesList = document.getElementById('notices-list');
    addBtn.onclick = () => { form.style.display = form.style.display === 'none' ? 'block' : 'none'; };

    // --- Government Notices Auto-fetch ---
    const govNoticesList = document.getElementById('gov-notices-list');
    // List of government RSS feeds (add more as needed)
    const govFeeds = [
        {
            name: 'Curriculum Development Centre (CDC)',
            url: 'https://moecdc.gov.np/rss',
            homepage: 'https://moecdc.gov.np/en'
        },
        {
            name: 'Department of Education (DoE)',
            url: 'https://doe.gov.np/rss',
            homepage: 'https://doe.gov.np/'
        },
        {
            name: 'Ministry of Education, Science and Technology (MoEST)',
            url: 'https://moest.gov.np/rss',
            homepage: 'https://moest.gov.np/'
        }
        // Add more feeds as needed
    ];
    function fetchGovNotices() {
        govNoticesList.innerHTML = '<li>Loading latest government notices...</li>';
        let allNotices = [];
        let loaded = 0;
        govFeeds.forEach(feed => {
            // Use rss2json.com as a proxy (for demo; replace with your backend for production)
            const apiUrl = `https://api.rss2json.com/v1/api.json?rss_url=${encodeURIComponent(feed.url)}`;
            fetch(apiUrl)
                .then(res => res.json())
                .then(data => {
                    if (data.status === 'ok' && data.items && data.items.length > 0) {
                        data.items.slice(0, 3).forEach(item => {
                            allNotices.push({
                                title: item.title,
                                link: item.link,
                                source: feed.name,
                                homepage: feed.homepage,
                                date: item.pubDate,
                                summary: item.description || ''
                            });
                        });
                    }
                })
                .catch(() => {})
                .finally(() => {
                    loaded++;
                    if (loaded === govFeeds.length) {
                        renderGovNotices(allNotices);
                    }
                });
        });
    }
    function renderGovNotices(notices) {
        if (!notices.length) {
            govNoticesList.innerHTML = '<li>No government notices available at this time.</li>';
            return;
        }
        // Sort by date, newest first
        notices.sort((a, b) => new Date(b.date) - new Date(a.date));
        govNoticesList.innerHTML = '';
        notices.forEach(notice => {
            const li = document.createElement('li');
            li.style.marginBottom = '1.1rem';
            li.style.display = 'flex';
            li.style.alignItems = 'flex-start';
            li.style.gap = '0.5em';
            li.innerHTML = `
                <div style="flex:1;">
                    <b><a href="${notice.link}" target="_blank" style="color:#2563eb;">${notice.title}</a></b><br>
                    <span style="font-size:0.97em;color:#444;">${notice.summary.replace(/<[^>]+>/g, '').slice(0, 120)}${notice.summary.length > 120 ? '...' : ''}</span><br>
                    <span style="font-size:0.93em;color:#888;">Source: <a href="${notice.homepage}" target="_blank">${notice.source}</a></span>
                </div>
                <button class="govnotice-share-btn" data-title="${notice.title}" data-url="${notice.link}" style="background:none;border:none;cursor:pointer;font-size:1.1em;align-self:center;" title="Share">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#2563eb" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="18" cy="5" r="3"/><circle cx="6" cy="12" r="3"/><circle cx="18" cy="19" r="3"/><line x1="8.59" y1="13.51" x2="15.42" y2="17.49"/><line x1="15.41" y1="6.51" x2="8.59" y2="10.49"/></svg>
                </button>
            `;
            govNoticesList.appendChild(li);
        });
        // Attach share logic to new buttons
        document.querySelectorAll('.govnotice-share-btn').forEach(btn => {
            btn.onclick = function(e) {
                e.stopPropagation();
                const rect = btn.getBoundingClientRect();
                createSharePopup(rect.right, rect.top, btn.dataset.title, btn.dataset.url);
            };
        });
    }
    fetchGovNotices();
    // Optionally, refresh every 10 minutes
    setInterval(fetchGovNotices, 10 * 60 * 1000);
    // --- End Government Notices Auto-fetch ---

    function createNoticeElement(title, content, source) {
        const noticeDiv = document.createElement('div');
        noticeDiv.style.marginBottom = '1.5rem';
        noticeDiv.style.padding = '1rem';
        noticeDiv.style.background = '#f4f8fb';
        noticeDiv.style.borderRadius = '8px';
        noticeDiv.style.boxShadow = '0 2px 8px rgba(37,99,235,0.07)';
        noticeDiv.innerHTML = `
            <div style='display:flex;justify-content:space-between;align-items:center;'>
                <div style='display:flex;align-items:center;gap:0.5em;flex:1;'>
                    <h3 style='color:#2563eb;margin:0 0 0.5rem 0;'>${title}</h3>
                    <button class="manualnotice-share-btn" data-title="${title}" data-url="${source ? source : location.href}" style="background:none;border:none;cursor:pointer;font-size:1.1em;align-self:center;" title="Share">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#2563eb" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="18" cy="5" r="3"/><circle cx="6" cy="12" r="3"/><circle cx="18" cy="19" r="3"/><line x1="8.59" y1="13.51" x2="15.42" y2="17.49"/><line x1="15.41" y1="6.51" x2="8.59" y2="10.49"/></svg>
                    </button>
                </div>
                <div class='notice-menu' style='position:relative;display:flex;align-items:center;'>
                    <button class='notice-menu-btn' style='background:none;border:none;font-size:1.5rem;cursor:pointer;padding:0 8px;'>‚ãÆ</button>
                    <div class='notice-menu-dropdown' style='display:none;position:absolute;right:0;top:28px;background:#fff;border:1px solid #bcd0ee;border-radius:6px;box-shadow:0 2px 8px rgba(0,0,0,0.08);z-index:10;'>
                        <button class='notice-edit' style='display:block;width:100%;background:none;border:none;padding:0.5rem 1.2rem;text-align:left;cursor:pointer;color:#2563eb;'>Edit</button>
                        <button class='notice-remove' style='display:block;width:100%;background:none;border:none;padding:0.5rem 1.2rem;text-align:left;cursor:pointer;color:#e74c3c;'>Remove</button>
                        <button class='notice-share' style='display:block;width:100%;background:none;border:none;padding:0.5rem 1.2rem;text-align:left;cursor:pointer;color:#2563eb;'>Share</button>
                        <button class='notice-insert-file' style='display:block;width:100%;background:none;border:none;padding:0.5rem 1.2rem;text-align:left;cursor:pointer;color:#2563eb;'>Insert File</button>
                        <button class='notice-insert-image' style='display:block;width:100%;background:none;border:none;padding:0.5rem 1.2rem;text-align:left;cursor:pointer;color:#2563eb;'>Insert Image</button>
                    </div>
                    <input type='file' class='notice-file-input' style='display:none;' accept='.pdf,.doc,.docx,.ppt,.pptx,.txt,.xls,.xlsx,.odt,.ods,.odp'>
                    <input type='file' class='notice-image-input' style='display:none;' accept='image/*'>
                </div>
            </div>
            <div class='notice-content' style='font-size:1.1rem;'>${content}</div>
            <div class='notice-attachments'></div>
            ${source ? `<div style='font-size:0.93em;color:#888;margin-top:0.5rem;'>Source: ${source}</div>` : ''}
        `;
        // Menu logic
        const menuBtn = noticeDiv.querySelector('.notice-menu-btn');
        const menuDropdown = noticeDiv.querySelector('.notice-menu-dropdown');
        menuBtn.onclick = (e) => {
            e.stopPropagation();
            menuDropdown.style.display = menuDropdown.style.display === 'block' ? 'none' : 'block';
            document.addEventListener('click', closeMenu);
        };
        function closeMenu(ev) {
            if (!menuDropdown.contains(ev.target) && ev.target !== menuBtn) {
                menuDropdown.style.display = 'none';
                document.removeEventListener('click', closeMenu);
            }
        }
        // Remove
        menuDropdown.querySelector('.notice-remove').onclick = () => {
            noticeDiv.remove();
        };
        // Share
        menuDropdown.querySelector('.notice-share').onclick = () => {
            const text = `Title: ${title}\nNotice: ${content}`;
            navigator.clipboard.writeText(text).then(() => {
                menuDropdown.style.display = 'none';
                alert('Notice copied to clipboard!');
            });
        };
        // Edit
        menuDropdown.querySelector('.notice-edit').onclick = () => {
            menuDropdown.style.display = 'none';
            // Replace content with editable form
            const editForm = document.createElement('form');
            editForm.innerHTML = `
                <input type='text' value='${title}' required style='width:100%;padding:0.7rem;margin-bottom:0.7rem;font-size:1.1rem;border:1px solid #bcd0ee;border-radius:5px;'>
                <textarea required style='width:100%;padding:0.7rem;height:120px;font-size:1.1rem;border:1px solid #bcd0ee;border-radius:5px;'>${content}</textarea>
                <button type='submit' style='background:#2563eb;color:#fff;border:none;padding:0.7rem 2rem;border-radius:5px;font-size:1rem;cursor:pointer;margin-top:0.5rem;'>Save</button>
            `;
            const noticeContent = noticeDiv.querySelector('.notice-content');
            noticeContent.style.display = 'none';
            noticeDiv.appendChild(editForm);
            editForm.onsubmit = function(ev) {
                ev.preventDefault();
                const newTitle = editForm.querySelector('input').value.trim();
                const newContent = editForm.querySelector('textarea').value.trim();
                if (newTitle && newContent) {
                    noticeDiv.querySelector('h3').textContent = newTitle;
                    noticeContent.textContent = newContent;
                    noticeContent.style.display = '';
                    editForm.remove();
                }
            };
        };
        // Insert File
        const fileInput = noticeDiv.querySelector('.notice-file-input');
        menuDropdown.querySelector('.notice-insert-file').onclick = () => {
            fileInput.click();
            menuDropdown.style.display = 'none';
        };
        fileInput.addEventListener('change', function(event) {
            const files = event.target.files;
            if (files && files[0]) {
                const fileLink = document.createElement('a');
                fileLink.href = URL.createObjectURL(files[0]);
                fileLink.download = files[0].name;
                fileLink.textContent = 'üìÑ ' + files[0].name;
                fileLink.style.display = 'block';
                fileLink.style.margin = '0.5rem 0';
                fileLink.style.color = '#2563eb';
                fileLink.style.fontWeight = '500';
                noticeDiv.querySelector('.notice-attachments').appendChild(fileLink);
            }
        });
        // Insert Image
        const imageInput = noticeDiv.querySelector('.notice-image-input');
        menuDropdown.querySelector('.notice-insert-image').onclick = () => {
            imageInput.click();
            menuDropdown.style.display = 'none';
        };
        imageInput.addEventListener('change', function(event) {
            const files = event.target.files;
            if (files && files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const img = document.createElement('img');
                    img.src = e.target.result;
                    img.style.width = '120px';
                    img.style.height = '90px';
                    img.style.objectFit = 'cover';
                    img.style.borderRadius = '6px';
                    img.style.margin = '0.5rem 0.5rem 0.5rem 0';
                    img.style.boxShadow = '0 2px 8px rgba(37,99,235,0.10)';
                    noticeDiv.querySelector('.notice-attachments').appendChild(img);
                };
                reader.readAsDataURL(files[0]);
            }
        });
        // Manual notice share button logic
        const shareBtn = noticeDiv.querySelector('.manualnotice-share-btn');
        if (shareBtn) {
            shareBtn.onclick = function(e) {
                e.stopPropagation();
                const rect = shareBtn.getBoundingClientRect();
                createSharePopup(rect.right, rect.top, title, source ? source : location.href);
            };
        }
        return noticeDiv;
    }
    form.onsubmit = function(e) {
        e.preventDefault();
        const title = document.getElementById('notice-title').value.trim();
        const content = document.getElementById('notice-content').value.trim();
        let source = prompt('Enter the source for this notice (e.g., website or person):', '');
        if (title && content) {
            const noticeDiv = createNoticeElement(title, content, source);
            noticesList.prepend(noticeDiv);
            form.reset();
            form.style.display = 'none';
        }
    };
    // --- Subnotice Share Buttons ---
    function createSharePopup(x, y, title, url) {
        // Remove any existing popup
        document.querySelectorAll('.subnotice-share-popup').forEach(e => e.remove());
        const popup = document.createElement('div');
        popup.className = 'subnotice-share-popup';
        popup.style.position = 'fixed';
        popup.style.left = x + 'px';
        popup.style.top = y + 'px';
        popup.style.background = '#fff';
        popup.style.border = '1px solid #bcd0ee';
        popup.style.borderRadius = '8px';
        popup.style.boxShadow = '0 2px 8px rgba(37,99,235,0.13)';
        popup.style.padding = '0.7em 1em';
        popup.style.zIndex = 1000;
        popup.innerHTML = `
            <div style='font-size:1em;margin-bottom:0.4em;'>Share:</div>
            <div style='display:flex;gap:0.7em;align-items:center;'>
                <a href="https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}&quote=${encodeURIComponent(title)}" target="_blank" title="Share on Facebook" style="display:inline-flex;align-items:center;"> 
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="#1877F3" xmlns="http://www.w3.org/2000/svg"><path d="M22.675 0h-21.35C.595 0 0 .592 0 1.326v21.348C0 23.408.595 24 1.325 24h11.495v-9.294H9.692v-3.622h3.128V8.413c0-3.1 1.893-4.788 4.659-4.788 1.325 0 2.463.099 2.797.143v3.24l-1.918.001c-1.504 0-1.797.715-1.797 1.763v2.313h3.587l-.467 3.622h-3.12V24h6.116C23.406 24 24 23.408 24 22.674V1.326C24 .592 23.406 0 22.675 0"/></svg>
                </a>
                <a href="https://www.messenger.com/share?link=${encodeURIComponent(url)}" target="_blank" title="Share on Messenger" style="display:inline-flex;align-items:center;"> 
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="#00B2FF" xmlns="http://www.w3.org/2000/svg"><path d="M12 2C6.477 2 2 6.021 2 11.09c0 2.54 1.01 4.84 2.84 6.59.15.14.23.34.19.54l-.62 2.27c-.14.51.36.96.85.76l2.49-1.02c.16-.07.34-.08.5-.03.98.27 2.02.42 3.09.42 5.523 0 10-4.021 10-9.09C22 6.021 17.523 2 12 2zm1.13 11.47l-2.13-2.27-4.13 2.27 5.13-5.47 2.13 2.27 4.13-2.27-5.13 5.47z"/></svg>
                </a>
                <a href="https://wa.me/?text=${encodeURIComponent(title + ' ' + url)}" target="_blank" title="Share on WhatsApp" style="display:inline-flex;align-items:center;"> 
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="#25D366" xmlns="http://www.w3.org/2000/svg"><path d="M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.481 5.236 3.48 8.414-.003 6.557-5.338 11.892-11.893 11.892-1.99-.001-3.951-.5-5.688-1.448L.057 24zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.434 9.889-9.885.002-2.651-1.033-5.139-2.917-7.025C16.13 3.89 13.644 2.858 10.998 2.857c-5.448 0-9.886 4.434-9.889 9.884-.001 2.225.651 3.891 1.746 5.634l-.999 3.648 3.798-.997zm11.387-5.464c-.074-.124-.272-.198-.57-.347-.297-.149-1.758-.868-2.031-.967-.272-.099-.47-.149-.669.149-.198.297-.768.967-.941 1.164-.173.198-.347.223-.644.074-.297-.149-1.255-.462-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.521.151-.174.2-.298.3-.497.099-.198.05-.372-.025-.521-.075-.149-.669-1.611-.916-2.206-.242-.579-.487-.501-.669-.51l-.57-.01c-.198 0-.52.074-.792.372s-1.04 1.016-1.04 2.479 1.065 2.876 1.213 3.074c.149.198 2.095 3.2 5.076 4.363.709.306 1.262.489 1.694.626.712.227 1.36.195 1.872.118.571-.085 1.758-.719 2.006-1.413.248-.695.248-1.29.173-1.413z"/></svg>
                </a>
                <button onclick="navigator.clipboard.writeText('${title} ${url}');this.innerHTML='<svg width=\'20\' height=\'20\' fill=\'#E1306C\' viewBox=\'0 0 24 24\'><path d=\'M12 2.163c3.204 0 3.584.012 4.85.07 1.366.062 2.633.334 3.608 1.308.974.974 1.246 2.241 1.308 3.608.058 1.266.069 1.646.069 4.85s-.012 3.584-.07 4.85c-.062 1.366-.334 2.633-1.308 3.608-.974.974-2.241 1.246-3.608 1.308-1.266.058-1.646.069-4.85.069s-3.584-.012-4.85-.07c-1.366-.062-2.633-.334-3.608-1.308-.974-.974-1.246-2.241-1.308-3.608C2.175 15.647 2.163 15.267 2.163 12s.012-3.584.07-4.85c.062-1.366.334-2.633 1.308-3.608.974-.974 2.241-1.246 3.608-1.308C8.416 2.175 8.796 2.163 12 2.163zm0-2.163C8.741 0 8.332.013 7.052.072 5.775.13 4.602.402 3.635 1.37 2.668 2.337 2.396 3.51 2.338 4.788 2.279 6.068 2.267 6.477 2.267 12c0 5.523.012 5.932.071 7.212.058 1.278.33 2.451 1.297 3.418.967.967 2.14 1.239 3.418 1.297 1.28.059 1.689.071 7.212.071s5.932-.012 7.212-.071c1.278-.058 2.451-.33 3.418-1.297.967-.967 1.239-2.14 1.297-3.418.059-1.28.071-1.689.071-7.212s-.012-5.932-.071-7.212c-.058-1.278-.33-2.451-1.297-3.418C19.451.402 18.278.13 17 .072 15.72.013 15.311 0 12 0z\'/><path d=\'M12 5.838A6.162 6.162 0 0 0 5.838 12 6.162 6.162 0 0 0 12 18.162 6.162 6.162 0 0 0 18.162 12 6.162 6.162 0 0 0 12 5.838zm0 10.324A4.162 4.162 0 0 1 7.838 12 4.162 4.162 0 0 1 12 7.838 4.162 4.162 0 0 1 16.162 12 4.162 4.162 0 0 1 12 16.162zm6.406-11.845a1.44 1.44 0 1 1-2.88 0 1.44 1.44 0 0 1 2.88 0z\'/></svg>';setTimeout(()=>this.innerHTML='<svg width=\'24\' height=\'24\' fill=\'#E1306C\' viewBox=\'0 0 24 24\'><path d=\'M12 2.163c3.204 0 3.584.012 4.85.07 1.366.062 2.633.334 3.608 1.308.974.974 1.246 2.241 1.308 3.608.058 1.266.069 1.646.069 4.85s-.012 3.584-.07 4.85c-.062 1.366-.334 2.633-1.308 3.608-.974.974-2.241 1.246-3.608 1.308-1.266.058-1.646.069-4.85.069s-3.584-.012-4.85-.07c-1.366-.062-2.633-.334-3.608-1.308-.974-.974-1.246-2.241-1.308-3.608C2.175 15.647 2.163 15.267 2.163 12s.012-3.584.07-4.85c.062-1.366.334-2.633 1.308-3.608.974-.974 2.241-1.246 3.608-1.308C8.416 2.175 8.796 2.163 12 2.163zm0-2.163C8.741 0 8.332.013 7.052.072 5.775.13 4.602.402 3.635 1.37 2.668 2.337 2.396 3.51 2.338 4.788 2.279 6.068 2.267 6.477 2.267 12c0 5.523.012 5.932.071 7.212.058 1.278.33 2.451 1.297 3.418.967.967 2.14 1.239 3.418 1.297 1.28.059 1.689.071 7.212.071s5.932-.012 7.212-.071c1.278-.058 2.451-.33 3.418-1.297.967-.967 1.239-2.14 1.297-3.418.059-1.28.071-1.689.071-7.212s-.012-5.932-.071-7.212c-.058-1.278-.33-2.451-1.297-3.418C19.451.402 18.278.13 17 .072 15.72.013 15.311 0 12 0z\'/><path d=\'M12 5.838A6.162 6.162 0 0 0 5.838 12 6.162 6.162 0 0 0 12 18.162 6.162 6.162 0 0 0 18.162 12 6.162 6.162 0 0 0 12 5.838zm0 10.324A4.162 4.162 0 0 1 7.838 12 4.162 4.162 0 0 1 12 7.838 4.162 4.162 0 0 1 16.162 12 4.162 4.162 0 0 1 12 16.162zm6.406-11.845a1.44 1.44 0 1 1-2.88 0 1.44 1.44 0 0 1 2.88 0z\'/></svg>',1200);" title="Copy for Instagram" style="background:none;border:none;cursor:pointer;display:inline-flex;align-items:center;">
                    <svg width="24" height="24" fill="#E1306C" viewBox="0 0 24 24"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 1.366.062 2.633.334 3.608 1.308.974.974 1.246 2.241 1.308 3.608.058 1.266.069 1.646.069 4.85s-.012 3.584-.07 4.85c-.062 1.366-.334 2.633-1.308 3.608-.974.974-2.241 1.246-3.608 1.308-1.266.058-1.646.069-4.85.069s-3.584-.012-4.85-.07c-1.366-.062-2.633-.334-3.608-1.308-.974-.974-1.246-2.241-1.308-3.608C2.175 15.647 2.163 15.267 2.163 12s.012-3.584.07-4.85c.062-1.366.334-2.633 1.308-3.608.974-.974 2.241-1.246 3.608-1.308C8.416 2.175 8.796 2.163 12 2.163zm0-2.163C8.741 0 8.332.013 7.052.072 5.775.13 4.602.402 3.635 1.37 2.668 2.337 2.396 3.51 2.338 4.788 2.279 6.068 2.267 6.477 2.267 12c0 5.523.012 5.932.071 7.212.058 1.278.33 2.451 1.297 3.418.967.967 2.14 1.239 3.418 1.297 1.28.059 1.689.071 7.212.071s5.932-.012 7.212-.071c1.278-.058 2.451-.33 3.418-1.297.967-.967 1.239-2.14 1.297-3.418.059-1.28.071-1.689.071-7.212s-.012-5.932-.071-7.212c-.058-1.278-.33-2.451-1.297-3.418C19.451.402 18.278.13 17 .072 15.72.013 15.311 0 12 0z"/><path d="M12 5.838A6.162 6.162 0 0 0 5.838 12 6.162 6.162 0 0 0 12 18.162 6.162 6.162 0 0 0 18.162 12 6.162 6.162 0 0 0 12 5.838zm0 10.324A4.162 4.162 0 0 1 7.838 12 4.162 4.162 0 0 1 12 7.838 4.162 4.162 0 0 1 16.162 12 4.162 4.162 0 0 1 12 16.162zm6.406-11.845a1.44 1.44 0 1 1-2.88 0 1.44 1.44 0 0 1 2.88 0z"/></svg>
                </button>
            </div>
        `;
        document.body.appendChild(popup);
        // Remove popup on click outside
        setTimeout(() => {
            document.addEventListener('click', function handler(e) {
                if (!popup.contains(e.target)) {
                    popup.remove();
                    document.removeEventListener('click', handler);
                }
            });
        }, 10);
    }
    document.querySelectorAll('.subnotice-share-btn').forEach(btn => {
        btn.onclick = function(e) {
            e.stopPropagation();
            const rect = btn.getBoundingClientRect();
            createSharePopup(rect.right, rect.top, btn.dataset.title, btn.dataset.url);
        };
    });
    // --- End Subnotice Share Buttons ---
    </script>
</body>
</html> 